<!DOCTYPE html>
<html>
    <head>
        <title>Study on Line Tracing Task | LPNC</title>

        <!-- jsPsych core library and plugins -->
      <script src="jspsych-6.3.0/jspsych.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-html-keyboard-response.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-image-keyboard-response.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-preload.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-call_function.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-html-button-response.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-survey-likert.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-fullscreen.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-survey-multi-choice.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-html-slider-response.js"></script>
      <script src="jspsych-6.3.0/plugins/jspsych-survey-text.js"></script>
      <script src="jspsych-6.3.0/css/jspsych.css"></script>
      <script src="jspsych-line-tracing.js"></script>
      <link href="jspsych-6.3.0/css/jspsych.css" rel="stylesheet" type="text/css">

      <!-- Line tracing task -->
      <script src="task/base64.js" type="text/javascript"></script>
      <script src="task/canvas2image.js" type="text/javascript"></script>
      <script src="task/jquery.js" type="text/javascript"></script>
      <script src="task/color_trace.js" type="text/javascript"></script>
      <link rel="stylesheet" href="css/custom.css"></link>

  </head>
  <body></body>

  <script>

/* Preload images */
  var preloadimages = ['img/milo_hello.gif',
                       'img/milo_showing_right.png',
                       'img/instructions1.png',
                       'img/instructions1bis.png',
                       'img/instructions2bis.png',
                       'img/instructions3.png',
                       'img/instructions4.png',
                       'img/instructions5.png',
                       'img/milo_showing_points.png',
                       'img/level1.png',
                       'img/level2.png',
                       'img/level3.png',
                       'img/conf_scale_0.png',
                       'img/conf_scale_1.png',
                       'img/conf_scale_2.png',
                       'img/conf_scale_3.png',
                       'img/conf_scale_4.png',
                       'img/win.png',
                       ];


/* welcome message */
      var welcome = {
        type: "html-button-response",
        choices: ["&#10095;"],
        stimulus: `
        <p class = "custom-font">Bonjour ! Bienvenue dans ce jeu. <br>
        <img src = "img/milo_hello.gif", height="150", width="150", align = center>
        <br>
        Je m'appelle Milo et c'est moi qui vais te guider dans cette nouvelle aventure !</p>
        <br>
        <p class = "continue-instructions">Appuie sur la flèche pour me suivre.</p>
        `,
      };


/* switching to fullscreen */
      var fullscreen = {
        type: 'fullscreen',
        message: `<p class = "custom-font">Pour commencer ce jeu, clique sur le bouton "Commencer"</p>`,
        button_label: 'Commencer',
        fullscreen_mode: true
      };

/* instructions trial */

      //general1
      var instructions_1 = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font">Un dessin va apparaître sur l'écran.</p>
          <p class = "custom-font">Tu devras le redessiner le plus précisément possible en bougeant ta souris.</p>
          <img src = "img/milo_showing_right.png", height="150", width="150">
          <img src = "img/instructions1.png", height="200", width="250">
          <p class = "continue-instructions">Appuie sur la flèche pour continuer.</p>
          `,
            };

      //general2
      var instructions_2 = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font">Pour commencer le jeu, tu vas devoir cliquer sur le rond vert : c'est le point de départ.</p>
          <img src = "img/instructions1bis.png", height="180", width="230">
          <p class = "custom-font">Un rond rouge va alors apparaître : c'est le point d'arrivée. </p>
          <img src = "img/instructions2bis.png", height="180", width="300">
          <p class = "custom-font">Le but est d'arriver sur le rond rouge en restant le plus possible sur les lignes du dessin.</p>
          <p class = "continue-instructions">Appuie sur la flèche pour commencer le jeu.</p>
          `,
            };

      //general3
      var instructions_3 = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font">Lorsque tu restes sur les lignes du dessin, ton tracé est vert, et tu gagnes des points.</p>
          <p class = "custom-font">Lorsque tu sors des lignes du dessin, ton tracé est rouge, et tu perds des points.</p>
          <p class = "custom-font">Le but est de gagner le plus de points possible.</p>
          <img src = "img/instructions3.png", height="200", width="250">
          <img src = "img/milo_showing_points.png", height="150", width="150">
          <p class = "continue-instructions">Appuie sur la flèche pour commencer le jeu.</p>
          `,
            };

      //level1
      var level1 = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font">Dans ce jeu, il y a aura trois niveaux.</p>
          <p class = "custom-font">Commençons par le premier niveau ! Tu es prêt(e) ?</p>
          <img src = "img/level1.png", height="309", width="553">
          <p class = "continue-instructions">Appuie sur la flèche pour commencer le jeu.</p>
          `,
            };

      //level2
      var level2 = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font">Bravo ! Tu as fini le premier niveau.</p>
          <p class = "custom-font">Continuons avec le deuxième niveau ! </p>
          <img src = "img/level2.png", height="309", width="553">
          <p class = "continue-instructions">Appuie sur la flèche pour passer au deuxième niveau.</p>
          `,
            };

      //level3
      var level3 = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font">Bravo ! Tu as fini le deuxième niveau.</p>
          <p class = "custom-font">Continuons avec le troisième et dernier niveau ! </p>
          <img src = "img/level3.png", height="309", width="553">
          <p class = "continue-instructions">Appuie sur la flèche pour passer au troisième niveau.</p>
          `,
            };


      //training phase 1 : with both visual and score feedback
      // var instructions_all_feedback = {
      //     type: "html-button-response",
      //     choices: ["&#10095;"],
      //     stimulus: `
      //     <p class = "custom-font"> </p>
      //     <p class = "continue-instructions">Appuie sur la flèche pour commencer le jeu.</p>
      //     `,
      //       };


      //training phase 2 : only score feedback
      var instructions_score_feedback = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font"> A partir de maintenant, le jeu va se compliquer ! </p>
          <p class = "custom-font"> Tu ne verras plus où tu es en train de dessiner mais tu verras la souris ! </p>
          <p class = "custom-font"> Essaies de rester le plus possible sur les lignes pour marquer des points ! </p>
          <img src = "img/instructions4.png", height="193", width="270">
          <p class = "continue-instructions">Appuie sur la flèche pour commencer le jeu.</p>
          `,
            };

      //test phase without feedback
      var instructions_test = {
          type: "html-button-response",
          choices: ["&#10095;"],
          stimulus: `
          <p class = "custom-font"> A partir de maintenant, le jeu va encore se compliquer ! </p>
          <p class = "custom-font"> Tu ne verras plus où tu es en train de dessiner, ni la souris ! </p>
          <p class = "custom-font"> Essaies de rester le plus possible sur les lignes ! </p>
          <img src = "img/instructions5.png", height="180", width="270">
          <p class = "continue-instructions">Appuie sur la flèche pour commencer le jeu.</p>
          `,
            };



/* Line tracing task */

// defining the timeline variables

var training_all_feedback_stimuli = [
  {figure_number: 0, difficulty: "1", orientation: "0"},
  {figure_number: 1, difficulty: "1", orientation: "10"},
  {figure_number: 2, difficulty: "1", orientation: "20"},
  {figure_number: 3, difficulty: "1", orientation: "30"},
  {figure_number: 4, difficulty: "1", orientation: "40"},
  {figure_number: 5, difficulty: "1", orientation: "50"},
  {figure_number: 6, difficulty: "1", orientation: "60"},
  {figure_number: 7, difficulty: "1", orientation: "70"},
  {figure_number: 8, difficulty: "1", orientation: "80"},
  {figure_number: 9, difficulty: "1", orientation: "90"},
  {figure_number: 10, difficulty: "1", orientation: "100"},
  {figure_number: 11, difficulty: "1", orientation: "110"},
  {figure_number: 12, difficulty: "1", orientation: "120"},
  {figure_number: 13, difficulty: "1", orientation: "130"},
  {figure_number: 14, difficulty: "1", orientation: "140"},
  {figure_number: 15, difficulty: "1", orientation: "150"},
  {figure_number: 16, difficulty: "1", orientation: "160"},
  {figure_number: 17, difficulty: "1", orientation: "170"},
  {figure_number: 18, difficulty: "1", orientation: "180"},
  {figure_number: 19, difficulty: "1", orientation: "190"},
  {figure_number: 20, difficulty: "1", orientation: "200"},
  {figure_number: 21, difficulty: "1", orientation: "210"},
  {figure_number: 22, difficulty: "1", orientation: "220"},
  {figure_number: 23, difficulty: "1", orientation: "230"},
  {figure_number: 24, difficulty: "1", orientation: "240"},
  {figure_number: 25, difficulty: "1", orientation: "250"},
  {figure_number: 26, difficulty: "1", orientation: "260"},
  {figure_number: 27, difficulty: "1", orientation: "270"},
  {figure_number: 28, difficulty: "1", orientation: "280"},
  {figure_number: 29, difficulty: "1", orientation: "290"},
  {figure_number: 30, difficulty: "1", orientation: "300"},
  {figure_number: 31, difficulty: "1", orientation: "310"},
  {figure_number: 32, difficulty: "1", orientation: "320"},
  {figure_number: 33, difficulty: "1", orientation: "330"},
  {figure_number: 34, difficulty: "1", orientation: "340"},
  {figure_number: 35, difficulty: "1", orientation: "350"},

  {figure_number: 0, difficulty: "2", orientation: "0"},
  {figure_number: 1, difficulty: "2", orientation: "10"},
  {figure_number: 2, difficulty: "2", orientation: "20"},
  {figure_number: 3, difficulty: "2", orientation: "30"},
  {figure_number: 4, difficulty: "2", orientation: "40"},
  {figure_number: 5, difficulty: "2", orientation: "50"},
  {figure_number: 6, difficulty: "2", orientation: "60"},
  {figure_number: 7, difficulty: "2", orientation: "70"},
  {figure_number: 8, difficulty: "2", orientation: "80"},
  {figure_number: 9, difficulty: "2", orientation: "90"},
  {figure_number: 10, difficulty: "2", orientation: "100"},
  {figure_number: 11, difficulty: "2", orientation: "110"},
  {figure_number: 12, difficulty: "2", orientation: "120"},
  {figure_number: 13, difficulty: "2", orientation: "130"},
  {figure_number: 14, difficulty: "2", orientation: "140"},
  {figure_number: 15, difficulty: "2", orientation: "150"},
  {figure_number: 16, difficulty: "2", orientation: "160"},
  {figure_number: 17, difficulty: "2", orientation: "170"},
  {figure_number: 18, difficulty: "2", orientation: "180"},
  {figure_number: 19, difficulty: "2", orientation: "190"},
  {figure_number: 20, difficulty: "2", orientation: "200"},
  {figure_number: 21, difficulty: "2", orientation: "210"},
  {figure_number: 22, difficulty: "2", orientation: "220"},
  {figure_number: 23, difficulty: "2", orientation: "230"},
  {figure_number: 24, difficulty: "2", orientation: "240"},
  {figure_number: 25, difficulty: "2", orientation: "250"},
  {figure_number: 26, difficulty: "2", orientation: "260"},
  {figure_number: 27, difficulty: "2", orientation: "270"},
  {figure_number: 28, difficulty: "2", orientation: "280"},
  {figure_number: 29, difficulty: "2", orientation: "290"},
  {figure_number: 30, difficulty: "2", orientation: "300"},
  {figure_number: 31, difficulty: "2", orientation: "310"},
  {figure_number: 32, difficulty: "2", orientation: "320"},
  {figure_number: 33, difficulty: "2", orientation: "330"},
  {figure_number: 34, difficulty: "2", orientation: "340"},
  {figure_number: 35, difficulty: "2", orientation: "350"},

  {figure_number: 0, difficulty: "3", orientation: "0"},
  {figure_number: 1, difficulty: "3", orientation: "10"},
  {figure_number: 2, difficulty: "3", orientation: "20"},
  {figure_number: 3, difficulty: "3", orientation: "30"},
  {figure_number: 4, difficulty: "3", orientation: "40"},
  {figure_number: 5, difficulty: "3", orientation: "50"},
  {figure_number: 6, difficulty: "3", orientation: "60"},
  {figure_number: 7, difficulty: "3", orientation: "70"},
  {figure_number: 8, difficulty: "3", orientation: "80"},
  {figure_number: 9, difficulty: "3", orientation: "90"},
  {figure_number: 10, difficulty: "3", orientation: "100"},
  {figure_number: 11, difficulty: "3", orientation: "110"},
  {figure_number: 12, difficulty: "3", orientation: "120"},
  {figure_number: 13, difficulty: "3", orientation: "130"},
  {figure_number: 14, difficulty: "3", orientation: "140"},
  {figure_number: 15, difficulty: "3", orientation: "150"},
  {figure_number: 16, difficulty: "3", orientation: "160"},
  {figure_number: 17, difficulty: "3", orientation: "170"},
  {figure_number: 18, difficulty: "3", orientation: "180"},
  {figure_number: 19, difficulty: "3", orientation: "190"},
  {figure_number: 20, difficulty: "3", orientation: "200"},
  {figure_number: 21, difficulty: "3", orientation: "210"},
  {figure_number: 22, difficulty: "3", orientation: "220"},
  {figure_number: 23, difficulty: "3", orientation: "230"},
  {figure_number: 24, difficulty: "3", orientation: "240"},
  {figure_number: 25, difficulty: "3", orientation: "250"},
  {figure_number: 26, difficulty: "3", orientation: "260"},
  {figure_number: 27, difficulty: "3", orientation: "270"},
  {figure_number: 28, difficulty: "3", orientation: "280"},
  {figure_number: 29, difficulty: "3", orientation: "290"},
  {figure_number: 30, difficulty: "3", orientation: "300"},
  {figure_number: 31, difficulty: "3", orientation: "310"},
  {figure_number: 32, difficulty: "3", orientation: "320"},
  {figure_number: 33, difficulty: "3", orientation: "330"},
  {figure_number: 34, difficulty: "3", orientation: "340"},
  {figure_number: 35, difficulty: "3", orientation: "350"},

  {figure_number: 0, difficulty: "4", orientation: "0"},
  {figure_number: 1, difficulty: "4", orientation: "10"},
  {figure_number: 2, difficulty: "4", orientation: "20"},
  {figure_number: 3, difficulty: "4", orientation: "30"},
  {figure_number: 4, difficulty: "4", orientation: "40"},
  {figure_number: 5, difficulty: "4", orientation: "50"},
  {figure_number: 6, difficulty: "4", orientation: "60"},
  {figure_number: 7, difficulty: "4", orientation: "70"},
  {figure_number: 8, difficulty: "4", orientation: "80"},
  {figure_number: 9, difficulty: "4", orientation: "90"},
  {figure_number: 10, difficulty: "4", orientation: "100"},
  {figure_number: 11, difficulty: "4", orientation: "110"},
  {figure_number: 12, difficulty: "4", orientation: "120"},
  {figure_number: 13, difficulty: "4", orientation: "130"},
  {figure_number: 14, difficulty: "4", orientation: "140"},
  {figure_number: 15, difficulty: "4", orientation: "150"},
  {figure_number: 16, difficulty: "4", orientation: "160"},
  {figure_number: 17, difficulty: "4", orientation: "170"},
  {figure_number: 18, difficulty: "4", orientation: "180"},
  {figure_number: 19, difficulty: "4", orientation: "190"},
  {figure_number: 20, difficulty: "4", orientation: "200"},
  {figure_number: 21, difficulty: "4", orientation: "210"},
  {figure_number: 22, difficulty: "4", orientation: "220"},
  {figure_number: 23, difficulty: "4", orientation: "230"},
  {figure_number: 24, difficulty: "4", orientation: "240"},
  {figure_number: 25, difficulty: "4", orientation: "250"},
  {figure_number: 26, difficulty: "4", orientation: "260"},
  {figure_number: 27, difficulty: "4", orientation: "270"},
  {figure_number: 28, difficulty: "4", orientation: "280"},
  {figure_number: 29, difficulty: "4", orientation: "290"},
  {figure_number: 30, difficulty: "4", orientation: "300"},
  {figure_number: 31, difficulty: "4", orientation: "310"},
  {figure_number: 32, difficulty: "4", orientation: "320"},
  {figure_number: 33, difficulty: "4", orientation: "330"},
  {figure_number: 34, difficulty: "4", orientation: "340"},
  {figure_number: 35, difficulty: "4", orientation: "350"},

  {figure_number: 0, difficulty: "5", orientation: "0"},
  {figure_number: 1, difficulty: "5", orientation: "10"},
  {figure_number: 2, difficulty: "5", orientation: "20"},
  {figure_number: 3, difficulty: "5", orientation: "30"},
  {figure_number: 4, difficulty: "5", orientation: "40"},
  {figure_number: 5, difficulty: "5", orientation: "50"},
  {figure_number: 6, difficulty: "5", orientation: "60"},
  {figure_number: 7, difficulty: "5", orientation: "70"},
  {figure_number: 8, difficulty: "5", orientation: "80"},
  {figure_number: 9, difficulty: "5", orientation: "90"},
  {figure_number: 10, difficulty: "5", orientation: "100"},
  {figure_number: 11, difficulty: "5", orientation: "110"},
  {figure_number: 12, difficulty: "5", orientation: "120"},
  {figure_number: 13, difficulty: "5", orientation: "130"},
  {figure_number: 14, difficulty: "5", orientation: "140"},
  {figure_number: 15, difficulty: "5", orientation: "150"},
  {figure_number: 16, difficulty: "5", orientation: "160"},
  {figure_number: 17, difficulty: "5", orientation: "170"},
  {figure_number: 18, difficulty: "5", orientation: "180"},
  {figure_number: 19, difficulty: "5", orientation: "190"},
  {figure_number: 20, difficulty: "5", orientation: "200"},
  {figure_number: 21, difficulty: "5", orientation: "210"},
  {figure_number: 22, difficulty: "5", orientation: "220"},
  {figure_number: 23, difficulty: "5", orientation: "230"},
  {figure_number: 24, difficulty: "5", orientation: "240"},
  {figure_number: 25, difficulty: "5", orientation: "250"},
  {figure_number: 26, difficulty: "5", orientation: "260"},
  {figure_number: 27, difficulty: "5", orientation: "270"},
  {figure_number: 28, difficulty: "5", orientation: "280"},
  {figure_number: 29, difficulty: "5", orientation: "290"},
  {figure_number: 30, difficulty: "5", orientation: "300"},
  {figure_number: 31, difficulty: "5", orientation: "310"},
  {figure_number: 32, difficulty: "5", orientation: "320"},
  {figure_number: 33, difficulty: "5", orientation: "330"},
  {figure_number: 34, difficulty: "5", orientation: "340"},
  {figure_number: 35, difficulty: "5", orientation: "350"},

  {figure_number: 0, difficulty: "6", orientation: "0"},
  {figure_number: 1, difficulty: "6", orientation: "10"},
  {figure_number: 2, difficulty: "6", orientation: "20"},
  {figure_number: 3, difficulty: "6", orientation: "30"},
  {figure_number: 4, difficulty: "6", orientation: "40"},
  {figure_number: 5, difficulty: "6", orientation: "50"},
  {figure_number: 6, difficulty: "6", orientation: "60"},
  {figure_number: 7, difficulty: "6", orientation: "70"},
  {figure_number: 8, difficulty: "6", orientation: "80"},
  {figure_number: 9, difficulty: "6", orientation: "90"},
  {figure_number: 10, difficulty: "6", orientation: "100"},
  {figure_number: 11, difficulty: "6", orientation: "110"},
  {figure_number: 12, difficulty: "6", orientation: "120"},
  {figure_number: 13, difficulty: "6", orientation: "130"},
  {figure_number: 14, difficulty: "6", orientation: "140"},
  {figure_number: 15, difficulty: "6", orientation: "150"},
  {figure_number: 16, difficulty: "6", orientation: "160"},
  {figure_number: 17, difficulty: "6", orientation: "170"},
  {figure_number: 18, difficulty: "6", orientation: "180"},
  {figure_number: 19, difficulty: "6", orientation: "190"},
  {figure_number: 20, difficulty: "6", orientation: "200"},
  {figure_number: 21, difficulty: "6", orientation: "210"},
  {figure_number: 22, difficulty: "6", orientation: "220"},
  {figure_number: 23, difficulty: "6", orientation: "230"},
  {figure_number: 24, difficulty: "6", orientation: "240"},
  {figure_number: 25, difficulty: "6", orientation: "250"},
  {figure_number: 26, difficulty: "6", orientation: "260"},
  {figure_number: 27, difficulty: "6", orientation: "270"},
  {figure_number: 28, difficulty: "6", orientation: "280"},
  {figure_number: 29, difficulty: "6", orientation: "290"},
  {figure_number: 30, difficulty: "6", orientation: "300"},
  {figure_number: 31, difficulty: "6", orientation: "310"},
  {figure_number: 32, difficulty: "6", orientation: "320"},
  {figure_number: 33, difficulty: "6", orientation: "330"},
  {figure_number: 34, difficulty: "6", orientation: "340"},
  {figure_number: 35, difficulty: "6", orientation: "350"},

  {figure_number: 0, difficulty: "7", orientation: "0"},
  {figure_number: 1, difficulty: "7", orientation: "10"},
  {figure_number: 2, difficulty: "7", orientation: "20"},
  {figure_number: 3, difficulty: "7", orientation: "30"},
  {figure_number: 4, difficulty: "7", orientation: "40"},
  {figure_number: 5, difficulty: "7", orientation: "50"},
  {figure_number: 6, difficulty: "7", orientation: "60"},
  {figure_number: 7, difficulty: "7", orientation: "70"},
  {figure_number: 8, difficulty: "7", orientation: "80"},
  {figure_number: 9, difficulty: "7", orientation: "90"},
  {figure_number: 10, difficulty: "7", orientation: "100"},
  {figure_number: 11, difficulty: "7", orientation: "110"},
  {figure_number: 12, difficulty: "7", orientation: "120"},
  {figure_number: 13, difficulty: "7", orientation: "130"},
  {figure_number: 14, difficulty: "7", orientation: "140"},
  {figure_number: 15, difficulty: "7", orientation: "150"},
  {figure_number: 16, difficulty: "7", orientation: "160"},
  {figure_number: 17, difficulty: "7", orientation: "170"},
  {figure_number: 18, difficulty: "7", orientation: "180"},
  {figure_number: 19, difficulty: "7", orientation: "190"},
  {figure_number: 20, difficulty: "7", orientation: "200"},
  {figure_number: 21, difficulty: "7", orientation: "210"},
  {figure_number: 22, difficulty: "7", orientation: "220"},
  {figure_number: 23, difficulty: "7", orientation: "230"},
  {figure_number: 24, difficulty: "7", orientation: "240"},
  {figure_number: 25, difficulty: "7", orientation: "250"},
  {figure_number: 26, difficulty: "7", orientation: "260"},
  {figure_number: 27, difficulty: "7", orientation: "270"},
  {figure_number: 28, difficulty: "7", orientation: "280"},
  {figure_number: 29, difficulty: "7", orientation: "290"},
  {figure_number: 30, difficulty: "7", orientation: "300"},
  {figure_number: 31, difficulty: "7", orientation: "310"},
  {figure_number: 32, difficulty: "7", orientation: "320"},
  {figure_number: 33, difficulty: "7", orientation: "330"},
  {figure_number: 34, difficulty: "7", orientation: "340"},
  {figure_number: 35, difficulty: "7", orientation: "350"},

  {figure_number: 0, difficulty: "8", orientation: "0"},
  {figure_number: 1, difficulty: "8", orientation: "10"},
  {figure_number: 2, difficulty: "8", orientation: "20"},
  {figure_number: 3, difficulty: "8", orientation: "30"},
  {figure_number: 4, difficulty: "8", orientation: "40"},
  {figure_number: 5, difficulty: "8", orientation: "50"},
  {figure_number: 6, difficulty: "8", orientation: "60"},
  {figure_number: 7, difficulty: "8", orientation: "70"},
  {figure_number: 8, difficulty: "8", orientation: "80"},
  {figure_number: 9, difficulty: "8", orientation: "90"},
  {figure_number: 10, difficulty: "8", orientation: "100"},
  {figure_number: 11, difficulty: "8", orientation: "110"},
  {figure_number: 12, difficulty: "8", orientation: "120"},
  {figure_number: 13, difficulty: "8", orientation: "130"},
  {figure_number: 14, difficulty: "8", orientation: "140"},
  {figure_number: 15, difficulty: "8", orientation: "150"},
  {figure_number: 16, difficulty: "8", orientation: "160"},
  {figure_number: 17, difficulty: "8", orientation: "170"},
  {figure_number: 18, difficulty: "8", orientation: "180"},
  {figure_number: 19, difficulty: "8", orientation: "190"},
  {figure_number: 20, difficulty: "8", orientation: "200"},
  {figure_number: 21, difficulty: "8", orientation: "210"},
  {figure_number: 22, difficulty: "8", orientation: "220"},
  {figure_number: 23, difficulty: "8", orientation: "230"},
  {figure_number: 24, difficulty: "8", orientation: "240"},
  {figure_number: 25, difficulty: "8", orientation: "250"},
  {figure_number: 26, difficulty: "8", orientation: "260"},
  {figure_number: 27, difficulty: "8", orientation: "270"},
  {figure_number: 28, difficulty: "8", orientation: "280"},
  {figure_number: 29, difficulty: "8", orientation: "290"},
  {figure_number: 30, difficulty: "8", orientation: "300"},
  {figure_number: 31, difficulty: "8", orientation: "310"},
  {figure_number: 32, difficulty: "8", orientation: "320"},
  {figure_number: 33, difficulty: "8", orientation: "330"},
  {figure_number: 34, difficulty: "8", orientation: "340"},
  {figure_number: 35, difficulty: "8", orientation: "350"},

  {figure_number: 0, difficulty: "9", orientation: "0"},
  {figure_number: 1, difficulty: "9", orientation: "10"},
  {figure_number: 2, difficulty: "9", orientation: "20"},
  {figure_number: 3, difficulty: "9", orientation: "30"},
  {figure_number: 4, difficulty: "9", orientation: "40"},
  {figure_number: 5, difficulty: "9", orientation: "50"},
  {figure_number: 6, difficulty: "9", orientation: "60"},
  {figure_number: 7, difficulty: "9", orientation: "70"},
  {figure_number: 8, difficulty: "9", orientation: "80"},
  {figure_number: 9, difficulty: "9", orientation: "90"},
  {figure_number: 10, difficulty: "9", orientation: "100"},
  {figure_number: 11, difficulty: "9", orientation: "110"},
  {figure_number: 12, difficulty: "9", orientation: "120"},
  {figure_number: 13, difficulty: "9", orientation: "130"},
  {figure_number: 14, difficulty: "9", orientation: "140"},
  {figure_number: 15, difficulty: "9", orientation: "150"},
  {figure_number: 16, difficulty: "9", orientation: "160"},
  {figure_number: 17, difficulty: "9", orientation: "170"},
  {figure_number: 18, difficulty: "9", orientation: "180"},
  {figure_number: 19, difficulty: "9", orientation: "190"},
  {figure_number: 20, difficulty: "9", orientation: "200"},
  {figure_number: 21, difficulty: "9", orientation: "210"},
  {figure_number: 22, difficulty: "9", orientation: "220"},
  {figure_number: 23, difficulty: "9", orientation: "230"},
  {figure_number: 24, difficulty: "9", orientation: "240"},
  {figure_number: 25, difficulty: "9", orientation: "250"},
  {figure_number: 26, difficulty: "9", orientation: "260"},
  {figure_number: 27, difficulty: "9", orientation: "270"},
  {figure_number: 28, difficulty: "9", orientation: "280"},
  {figure_number: 29, difficulty: "9", orientation: "290"},
  {figure_number: 30, difficulty: "9", orientation: "300"},
  {figure_number: 31, difficulty: "9", orientation: "310"},
  {figure_number: 32, difficulty: "9", orientation: "320"},
  {figure_number: 33, difficulty: "9", orientation: "330"},
  {figure_number: 34, difficulty: "9", orientation: "340"},
  {figure_number: 35, difficulty: "9", orientation: "350"},

];

var training_score_feedback_stimuli = [
  // {figure_number: 1, },
  // {figure_number: 1, },
  // {figure_number: 2, },
  // {figure_number: 3, },
  {figure_number: 12, },
  {figure_number: 13, },
  {figure_number: 14, },
  {figure_number: 15, },
  {figure_number: 16, },

];

var test_stimuli = [
  // {figure_number: 1, },
  {figure_number: 12, },
  {figure_number: 13, },
  {figure_number: 14, },
  {figure_number: 15, },
  {figure_number: 16, },
];

var difficulty = [
  if
]

// -------- psychophysical scale ---------

// Defining the psychophysical scale
var n_consecutive_success = 0;
var n_consecutive_failure = 0;
var figure_difficulty = 14;

// 1: training phase with visual and score feedback
var training_all_feedback = {
  type: "jspsych-line-tracing",
  // Because we define the figure number at the onset of the trial, we do not need to specify it here.
  // figure_number: jsPsych.timelineVariable('figure_number'),
  trace_color: "color",
  score_feedback: true,
  final_score_feedback: true,
  start_instructions: `<p class = "custom-font">Clique sur le rond vert pour commencer !</p>`,
  draw_instructions: `<p class = "custom-font">Rejoins le rond rouge en restant sur les lignes du dessin</p>`,
  end_instructions: `<p class = "custom-font">Tu as fini ce dessin. Bravo !</p>`,
  stimulus: '',
  prompt: '',
  choices: ["&#10095;"],
  on_start: function(training_all_feedback) {
    training_all_feedback.figure_number = figure_difficulty;
  },
  data: {},
  on_finish: function(data){
  data_score = data.score;
  if (data_score > 5) {
    var success = true;
  } else {
    var success = false;
  };
  // increment consecutive success/failure
  if (success == true) {
    n_consecutive_success = n_consecutive_success + 1;
    n_consecutive_failure = 0;
  } else {
    n_consecutive_failure = n_consecutive_failure + 1;
    n_consecutive_success = 0;
  };

  // check whether there are 2 consecutive failures/success
  // if so, adapt the difficulty accordingly
  if (n_consecutive_success == 2) {
    figure_difficulty = figure_difficulty + 1;
    n_consecutive_success = 0;
  } else if (n_consecutive_failure == 1) {
    figure_difficulty = figure_difficulty - 1;
    n_consecutive_failure = 0;
  } else {
    figure_difficulty = figure_difficulty;
  };

},
};

// 2: training phase with score feedback only (no visual feedback)
var training_score_feedback = {
  type: "jspsych-line-tracing",
  figure_number: jsPsych.timelineVariable('figure_number'),
  trace_color: "transparent",
  score_feedback: false,
  final_score_feedback: true,
  cursor_display: true,
  start_instructions: `<p class = "custom-font">Clique sur le rond vert pour commencer !</p>`,
  draw_instructions: `<p class = "custom-font">Rejoins le rond rouge en restant sur les lignes du dessin</p>`,
  end_instructions: `<p class = "custom-font">Tu as fini ce dessin. Bravo ! </p>`,
  stimulus: ``,
  prompt: '',
  choices: ["&#10095;"],
  data: {},
  on_finish: function(data){
    data_score = data.score;
    data_score_falsed = data_score -1;
}
};

// 3: test phase : without feedback
var test_phase = {
  type: "jspsych-line-tracing",
  figure_number: jsPsych.timelineVariable('figure_number'),
  trace_color: "transparent",
  score_feedback: false,
  final_score_feedback: false,
  start_instructions: `<p class = "custom-font">Clique sur le rond vert pour commencer !</p>`,
  draw_instructions: `<p class = "custom-font">Rejoins le rond rouge en restant sur les lignes du dessin</p>`,
  end_instructions: `<p class = "custom-font">Tu as fini ce dessin. Bravo !</p>`,
  stimulus: ``,
  prompt: '',
  choices: ["&#10095;"],
  data: {},
  on_finish: function(data){
    data_score = data.score;
    data_score_falsed = data_score -1;
  }
};


/* Confidence scale */

    var confidence = {
        type: 'html-slider-response',
        stimulus:"<p class = 'custom-font'>A ton avis, sur un maximum de 10, quel score as-tu fait?</p>",
        labels: ["<p class = 'custom-font'>0 <br> <img src = 'img/conf_scale_0.png', height = 50px, width = 50px><br></p>",
                 "<p class = 'custom-font'>1 <br><br></p>",
                 "<p class = 'custom-font'>2 <br><br></p>",
                 "<p class = 'custom-font'>3 <br><br></p>",
                 "<p class = 'custom-font'>4 <br><br></p>",
                 "<p class = 'custom-font'>5 <br> <img src = 'img/conf_scale_2.png', height = 50px, width = 50px><br></p>",
                 "<p class = 'custom-font'>6 <br><br></p>",
                 "<p class = 'custom-font'>7 <br><br></p>",
                 "<p class = 'custom-font'>8 <br><br></p>",
                 "<p class = 'custom-font'>9 <br><br></p>",
                 "<p class = 'custom-font'>10 <br> <img src = 'img/conf_scale_4.png', height = 50px, width = 50px><br></p>"
               ],
        min: 0,
        max: 10,
        step: 1,
        slider_start: 5,
        prompt: "<p class = 'custom-font'> <br> </p>",
        require_movement: true,
        button_label: "&#10095;",


    };



/* Looping the procedure using timeline variables */

// 1: training phase with visual and score feedback
var training_all_feedback_procedure = {
  timeline: [
    training_all_feedback,
    confidence,
  ],
  timeline_variables: training_all_feedback_stimuli,
  randomize_order: true,
  sample: {
          // without replacement: once a figure is picked, it cannot be picked again
          // type: 'without-replacement',
          type: 'with-replacement',
          // number of trials of the procedure
          size: 3,
  }
};

// 2: training phase with score feedback only (no visual feedback)
var training_score_feedback_procedure = {
  timeline: [
    training_score_feedback,
    confidence,
  ],
  timeline_variables: training_score_feedback_stimuli,
  randomize_order: true,
  sample: {
          // without replacement: once a figure is picked, it cannot be picked again
          type: 'without-replacement',
          // number of trials of the procedure
          size: 3,
  }
};

// 3: test phase : without feedback
var test_procedure = {
  timeline: [
    test_phase,
    confidence,
  ],
  timeline_variables: test_stimuli,
  randomize_order: true,
  sample: {
          // without replacement: once a figure is picked, it cannot be picked again
          type: 'without-replacement',
          // number of trials of the procedure
          size: 5,
  }
};



/*End of the line tracing task*/

    var end_task = {
      type: "html-button-response",
      choices: ["&#10095;"],
      stimulus: `
        <p class = "custom-font">Bravo ! Tu as terminé le jeu et tu t'en es très bien sorti ! Merci d'avoir joué avec moi.</p>
        <img src = "img/win.png", height="300", width="400">
        <p class = "custom-font">Avant de partir, j'ai quelques questions pour toi !</p>
        <p class = "continue-instructions">Appuie sur la flèche pour continuer.</p>
        `,
    };


/* Demographic questions*/

    var age = {
       type: 'survey-text',
       questions: [{prompt: "<span class = 'custom-font'>Quel âge as-tu ?</span>", required : true}],
     };

    var sex = {
     type: 'survey-multi-choice',
     questions: [{prompt: "<span class = 'custom-font'>Tu es </span>",
     options: ["Un garçon", "Une fille", "Autre"],
     required: true, horizontal: true}],
     };

     var difficulty = {
      type: 'survey-multi-choice',
      questions: [{prompt: "<span class = 'custom-font'>Comment as-tu trouvé ce jeu ? </span>",
      options: ["Très difficile", "Difficile", "Facile", "Très facile"],
      required: true, horizontal: true}],
      };

    var comments = {
      type: 'survey-text',
      questions: [{prompt: "<p class = 'custom-font'>Cette question s'adresse aux parents.</p><p>Avez-vous des remarques concernant cet exercice (difficulté de la tâche, motivation de votre enfant...)</p>"}],
      };


/*End of full screen*/

        var fullscreen_exit = {
            type: 'fullscreen',
            fullscreen_mode: false
          };

/*End of study*/

    var ending = {
        type: "html-keyboard-response",
        stimulus: `
        <p class = "custom-font">Merci d'être allé au bout !</p>
        <p class = "custom-font">A bientôt peut être.</p>
        <img src = "img/milo_hello.gif", height="150", width="150", align = center>
      `};


/* create timeline */
    var timeline = [];
    timeline.push(welcome,
                  // fullscreen,
                  // level1,
                  // instructions_1,
                  // instructions_2,
                  // instructions_3,
                  training_all_feedback_procedure,
                  // level2,
                  // instructions_score_feedback,
                  // training_score_feedback_procedure,
                  // level3,
                  // instructions_test,
                  // test_procedure,
                  // end_task,
                  // age,
                  // sex,
                  // difficulty,
                  // comments,
                  // fullscreen_exit,
                  ending);


  /* start the experiment */
      jsPsych.init({
        timeline: timeline,
        preload_images: preloadimages,
        show_progress_bar : true,
        on_finish: function(){
          jsPsych.data.displayData();
        }
        });



   </script>
</html>
